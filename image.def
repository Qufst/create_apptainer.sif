Bootstrap: docker
From: alpine:latest

%labels
    AUTHOR Quentin Festor
    VERSION 1.0
    DESCRIPTION "test de cr√©ation de sif pour computo"

%post
    apk add wget tar bzip2 bash
    wget -O environment.yml https://raw.githubusercontent.com/Qufst/create_apptainer.sif/main/environment.yml

    wget -qO- micromamba.tar.bz2 https://github.com/mamba-org/micromamba-releases/releases/latest/download/micromamba-linux-64.tar.bz2
    tar -xvjf micromamba.tar.bz2 -C /usr/local/bin --strip-components=1
    chmod +x micromamba-linux-64
    ./micromamba-linux-64
    micromamba --version


    micromamba create -y -n myenv -f environment.yml


%environment
    eval "$(micromamba shell hook --shell )"
    micromamba activate myenv
%help
    Utilisation : apptainer run image.sif --option
