Bootstrap: docker
From: continuumio/miniconda3:4.10.3-alpine

%help
    Container with conda on Alpine Linux.

%files
    environment.yml

%environment
    export ENV_NAME=myenv

%post
    ENV_NAME=myenv

    # Installer Mamba
    conda install -c conda-forge mamba -y

    # CrÃ©er l'environnement conda avec Mamba
    mamba env create -f /environment.yml -p /opt/conda/envs/$ENV_NAME
    conda clean --all

    # Configure l'activation de l'environnement
    echo ". /opt/conda/etc/profile.d/conda.sh" >> /environment.sh
    echo "conda activate $ENV_NAME" >> /environment.sh
    echo "export PATH=/opt/conda/envs/$ENV_NAME/bin:\$PATH" >> /environment.sh
    chmod +x /environment.sh

%runscript
    . /environment.sh
    exec "$@"





