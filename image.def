Bootstrap: docker
From: alpine:latest

%labels
    AUTHOR Quentin Festor
    VERSION 1.0
    DESCRIPTION "test de création de sif pour computo"

%post
    apk add wget tar bzip2 bash curl
    # Étape 1: Télécharger le fichier micromamba-linux-64.tar.bz2
    wget https://github.com/mamba-org/micromamba-releases/releases/latest/download/micromamba-linux-64.tar.bz2 -O micromamba-linux-64.tar.bz2

    # Étape 2: Décompresser le fichier téléchargé
    mkdir mamba
    tar -jxvf  micromamba-linux-64.tar.bz2 -C mamba
    ls -la mamba/bin/micromamba
    cat mamba/bin/micromamba

    # Étape 4: Créer un environnement à partir du fichier environment.yml
    mamba/bin/micromamba create -y -n myenv -f environment.yml


%environment
    eval "$(mamba/bin/micromamba shell hook --shell )"
    mamba/bin/micromamba activate myenv
%help
    Utilisation : apptainer run image.sif --option
