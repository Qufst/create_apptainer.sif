Bootstrap: docker
From: drtools/alpine-miniconda

%help
    Container with Micromamba on Alpine Linux.

%environment
    export PATH=/opt/micromamba/bin:$PATH

%post
    # Installer les dépendances
    apk update && apk add --no-cache \
        bash \
        curl \
        wget \
        ca-certificates \
        bzip2 \
        libstdc++ \
        git && \
        rm -rf /var/cache/apk/*

    # Installer Micromamba
    wget -O opt/environment.yml https://raw.githubusercontent.com/Qufst/create_apptainer.sif/main/environment.yml
    conda install -y -c conda-forge micromamba

    # Créer un environnement Micromamba et installer des paquets de base
    micromamba create -y -n myenv -f opt/environment.yml
    micromamba clean --all --yes

%runscript
    micromamba activate myenv
    exec /bin/bash "$@"

%startscript
    exec /bin/bash




