Bootstrap: docker
From: continuumio/miniconda3:4.10.3-alpine

%help
    Container with conda on Alpine Linux.

%files
    environment.yml

%post
    ENV_NAME=myenv

    # Installer Mamba
    conda install -c conda-forge mamba -y

    # Cr√©er l'environnement conda avec Mamba
    mamba env create -f /environment.yml -p /opt/conda/envs/$ENV_NAME
    conda clean --all --yes
    export MAMBA_ROOT_PREFIX=find / --name mamba
    eval "$(mamba shell hook -s posix)"
    mamba activate
    mamba install -y -q -f environment.yml
    mamba clean -all --yes

%environment
    export MAMBA_ROOT_PREFIX=find / --name mamba
    eval "$(mamba shell hook -s posix)"
    mamba env create -f /environment.yml -p /opt/conda/envs/myenv

%runscript
    python
    exec "$@"





