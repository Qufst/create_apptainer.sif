Bootstrap: docker
From: alpine:latest

%labels
    AUTHOR Quentin Festor
    VERSION 1.0
    DESCRIPTION "test de cr√©ation de sif pour computo"

%post
    apk add --no-cache curl
    wget -O environment.yml https://raw.githubusercontent.com/Qufst/create_apptainer.sif/main/environment.yml

    curl -L -o /usr/local/bin/micromamba https://micro.mamba.pm/api/micromamba/linux-64/latest
    chmod +x /usr/local/bin/micromamba
    mkdir -p /opt/mamba
    /usr/local/bin/micromamba shell init -s bash -p /opt/mamba
    export PATH=/opt/mamba/bin:$PATH
    micromamba create -y -f environment.yml -p /opt/mamba
    
%environment
    eval "$(micromamba shell hook --shell )"
    micromamba activate myenv

%help
    Utilisation : apptainer run image.sif --option
