Bootstrap: docker
From: mambaorg/micromamba:alpine


%environment
    micromamba install -y -f environment.yml
    micromamba activate myenv

%post
    wget -qO- https://quarto.org/download/latest/quarto-linux-amd64.tar.gz | tar -xvj $HOME
    export PATH=$HOME/quarto/bin:$PATH

    mkdir -p ~/.local/bin
    ~/.TinyTeX/bin/x86_64-linux/tlmgr option sys_bin ~/.local/bin
    ~/.TinyTeX/bin/x86_64-linux/tlmgr path add
    ~/.TinyTeX/bin/x86_64-linux/tlmgr update --self
    ~/.TinyTeX/bin/x86_64-linux/tlmgr install libertinus-fonts

    quarto add --no-prompt computorg/computo-quarto-extension

%runscript
    quarto publish index.qmd
