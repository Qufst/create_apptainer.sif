BootStrap: docker
From: r-base:4.3.2

%post
    # Update the package list and install required system dependencies
    apt-get update && apt-get install -y \
        libcurl4-openssl-dev \
        libssl-dev \
        libxml2-dev \
        wget \
        tar \
        file \
        git \
        python3-pip

    # Install Jupyter
    pip3 install jupyter

    # Install R packages
    R --no-echo -e 'install.packages("devtools", repos="https://cloud.r-project.org/")'
    

    QUARTO_VERSION=1.5.54
    mkdir -p /opt/quarto
    wget -qO- https://github.com/quarto-dev/quarto-cli/releases/download/v${QUARTO_VERSION}/quarto-${QUARTO_VERSION}-linux-amd64.tar.gz | tar -xz -C /opt/quarto --strip-components=1

    /opt/quarto/bin/quarto add --no-prompt computorg/computo-quarto-extension
    # Add Quarto to PATH
    echo 'export PATH=/opt/quarto/bin:$PATH' >> /etc/profile

%runscript
    exec R "$@"
